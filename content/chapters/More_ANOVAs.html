<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Biostatistics! - More ANOVAs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/acknowledgements.html" rel="next">
<link href="../../content/chapters/Compare_means_among_populations.html" rel="prev">
<link href="../../images/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<link href="../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/Introduction.html">Chapters</a></li><li class="breadcrumb-item"><a href="../../content/chapters/More_ANOVAs.html">More ANOVAs</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/image-from-rawpixel-id-547642-jpeg.jpg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Biostatistics: Concepts and approaches for collecting good data and turning it into knowledge!</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://www.gosnelllab.com/" rel="" title="Gosnell lab website" class="quarto-navigation-tool px-1" aria-label="Gosnell lab website"><i class="bi bi-globe"></i></a>
    <a href="https://github.com/jsgosnell" rel="" title="J. Stephen Gosnell github" class="quarto-navigation-tool px-1" aria-label="J. Stephen Gosnell github"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Before the first class</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Chapters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Acquiring_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acquiring data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/summarizing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summarizing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hypothesis testing starting with binomial tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Tests_for_continuous_data_from_one_sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tests for continuous data from one sample</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Compare_proportions_among_populations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compare proportions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/chapters/Compare_means_among_populations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compare means among groups</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/chapters/More_ANOVAs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">More ANOVAs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/acknowledgements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/additional_resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Additional resources</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/references.bib" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Download a full reference list!</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Practice Problems</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/practice_problems/6_Comparing_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compare means among groups</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Appendix</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Intro_to_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started with R!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Intro_to_Rmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started with Rmarkdown!</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/Intro_to_ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started with ggpplot2!</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#example-back-to-the-birds" id="toc-example-back-to-the-birds" class="nav-link active" data-scroll-target="#example-back-to-the-birds">Example: Back to the birds</a></li>
  <li><a href="#how-do-we-analyze-this-data" id="toc-how-do-we-analyze-this-data" class="nav-link" data-scroll-target="#how-do-we-analyze-this-data">How do we analyze this data?</a></li>
  <li><a href="#lack-of-independence" id="toc-lack-of-independence" class="nav-link" data-scroll-target="#lack-of-independence">Lack of Independence</a></li>
  <li><a href="#blocking-two-way-anovasand-paired-t-tests" id="toc-blocking-two-way-anovasand-paired-t-tests" class="nav-link" data-scroll-target="#blocking-two-way-anovasand-paired-t-tests">Blocking, two-way ANOVAs,and paired t-tests</a>
  <ul class="collapse">
  <li><a href="#t-test-connections" id="toc-t-test-connections" class="nav-link" data-scroll-target="#t-test-connections">t-test connections</a></li>
  <li><a href="#more-than-2-measurements-back-to-the-linear-model" id="toc-more-than-2-measurements-back-to-the-linear-model" class="nav-link" data-scroll-target="#more-than-2-measurements-back-to-the-linear-model">More than 2 measurements? Back to the linear model</a></li>
  </ul></li>
  <li><a href="#other-ways-to-be-in-multiple-groups" id="toc-other-ways-to-be-in-multiple-groups" class="nav-link" data-scroll-target="#other-ways-to-be-in-multiple-groups">Other ways to be in multiple groups</a>
  <ul class="collapse">
  <li><a href="#intepreting-interactions" id="toc-intepreting-interactions" class="nav-link" data-scroll-target="#intepreting-interactions">Intepreting interactions</a></li>
  </ul></li>
  <li><a href="#other-options" id="toc-other-options" class="nav-link" data-scroll-target="#other-options">Other options</a></li>
  <li><a href="#plotting-outcomes" id="toc-plotting-outcomes" class="nav-link" data-scroll-target="#plotting-outcomes">Plotting outcomes</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next steps</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jsgosnell/cuny_biostats_book/edit/main/content/chapters/More_ANOVAs.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jsgosnell/cuny_biostats_book/blob/main/content/chapters/More_ANOVAs.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/jsgosnell/cuny_biostats_book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">More ANOVAs</h1>
<p class="subtitle lead">Dealing with multiple group membership and interactions</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- COMMENT NOT SHOW IN ANY OUTPUT: Code chunk below sets overall defaults for .qmd file; these inlcude showing output by default and looking for files relative to .Rpoj file, not .qmd file, which makes putting filesin different folders easier  -->
<p>In the last chapter we introduced the idea of comparing means among populations (one-way ANOVAs, our first linear models). However, the units that we measure may belong to multiple groups. We will extend our analysis of variance to consider multiple group membership and interactions in this chapter. As a starting point, consider that group membership may be an inherent property of the unit we measure or we may assign it.</p>
<section id="example-back-to-the-birds" class="level2">
<h2 class="anchored" data-anchor-id="example-back-to-the-birds">Example: Back to the birds</h2>
<p>One of the last chapters practice problems focused bird feathers. While studying feather color in Northern flickers (<em>Colaptes auratus</em>), <span class="citation" data-cites="wiebe2002">Wiebe and Bortolotti (<a href="#ref-wiebe2002" role="doc-biblioref">2002</a>)</span> noted that ~25% of birds had one or more “odd” tail feathers. They decided to compare the color of these odd and “typical” feathers.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://commons.wikimedia.org/wiki/File:Northern_Flicker_(4508135578).jpg"><img src="../..\images/Northern_Flicker_(4508135578).jpg" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">Northern Flicker. Mike’s Birds, CC BY-SA 2.0 &lt;https://creativecommons.org/licenses/by-sa/2.0&gt;, via Wikimedia Commons</figcaption>
</figure>
</div>
<p>Example and data provided by <span class="citation" data-cites="mcdonald2014">McDonald (<a href="#ref-mcdonald2014" role="doc-biblioref">2014</a>)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paged_table</span>(feather)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Bird"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Feather_type"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Color_index"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"Typical","3":"-0.255"},{"1":"B","2":"Typical","3":"-0.213"},{"1":"C","2":"Typical","3":"-0.190"},{"1":"D","2":"Typical","3":"-0.185"},{"1":"E","2":"Typical","3":"-0.045"},{"1":"F","2":"Typical","3":"-0.025"},{"1":"G","2":"Typical","3":"-0.015"},{"1":"H","2":"Typical","3":"0.003"},{"1":"I","2":"Typical","3":"0.015"},{"1":"J","2":"Typical","3":"0.020"},{"1":"K","2":"Typical","3":"0.023"},{"1":"L","2":"Typical","3":"0.040"},{"1":"M","2":"Typical","3":"0.040"},{"1":"N","2":"Typical","3":"0.050"},{"1":"O","2":"Typical","3":"0.055"},{"1":"P","2":"Typical","3":"0.058"},{"1":"A","2":"Odd","3":"-0.324"},{"1":"B","2":"Odd","3":"-0.185"},{"1":"C","2":"Odd","3":"-0.299"},{"1":"D","2":"Odd","3":"-0.144"},{"1":"E","2":"Odd","3":"-0.027"},{"1":"F","2":"Odd","3":"-0.039"},{"1":"G","2":"Odd","3":"-0.264"},{"1":"H","2":"Odd","3":"-0.077"},{"1":"I","2":"Odd","3":"-0.017"},{"1":"J","2":"Odd","3":"-0.169"},{"1":"K","2":"Odd","3":"-0.096"},{"1":"L","2":"Odd","3":"-0.330"},{"1":"M","2":"Odd","3":"-0.346"},{"1":"N","2":"Odd","3":"-0.191"},{"1":"O","2":"Odd","3":"-0.128"},{"1":"P","2":"Odd","3":"-0.182"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="how-do-we-analyze-this-data" class="level2">
<h2 class="anchored" data-anchor-id="how-do-we-analyze-this-data">How do we analyze this data?</h2>
<p>We may first note that we have a continuous measurement (feather color, measured using color hues from a digital camera and another statistical technique that we will not go into here) and a categorical variable (feather type, with levels “typical” and “odd”). This hopefully reminds you of an ANOVA/t-test!</p>
<p>We could plot the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(feather, <span class="fu">aes</span>(<span class="at">x=</span>Feather_type, <span class="at">y=</span> Color_index, <span class="at">color=</span>Feather_type))<span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()<span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span> <span class="st">"Color index"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Feather type"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Comparing odd and typical feathers in Northern flickers"</span>)<span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as
of ggplot2 3.3.4.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Develop a set of hypotheses:</p>
<p><span class="math display">\[
\begin{split}
H_O: \mu_{\textrm{odd feather color}} = \mu_{\textrm{typical feather color}}\\
H_A: \mu_{\textrm{odd feather color}} \neq \mu_{\textrm{typical feather color}}\\
\end{split}
\]</span></p>
<p>and test them using a t-test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Color_index <span class="sc">~</span> Feather_type, <span class="at">data=</span>feather)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Color_index by Feather_type
t = -3.56, df = 29.971, p-value = 0.00126
alternative hypothesis: true difference in means between group Odd and group Typical is not equal to 0
95 percent confidence interval:
 -0.21579254 -0.05845746
sample estimates:
    mean in group Odd mean in group Typical 
            -0.176125             -0.039000 </code></pre>
</div>
</div>
<p>or, using more generalizable functions, a linear model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(<span class="fu">lm</span>(Color_index <span class="sc">~</span> Feather_type, <span class="at">data=</span>feather), <span class="at">type =</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Color_index
              Sum Sq Df F value    Pr(&gt;F)    
(Intercept)  0.49632  1  41.816 3.814e-07 ***
Feather_type 0.15043  1  12.674  0.001259 ** 
Residuals    0.35607 30                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We find a significant p value, <strong>but we did not check assumptions</strong>. For linear models (remember, $i.i.d.&nbsp;N(,)$, we could use our visual checks</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lm</span>(Color_index <span class="sc">~</span> Feather_type, <span class="at">data=</span>feather))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Which appears ok, but there is a problem.</p>
<p>Our data are not independent!</p>
</section>
<section id="lack-of-independence" class="level2">
<h2 class="anchored" data-anchor-id="lack-of-independence">Lack of Independence</h2>
<p>Odd and typical feathers were measured on a single bird (note the <em>Bird</em> column) in the dataset. We might assume feathers on a given bird are more closely related in color than feathers on different birds. This could be due to diet or other factors making all feathers on a given bird brighter or darker than those on another. Regardless of reason (and “good” p value), we know the measurements are linked in some way. Note we could “connect” individual observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(feather, <span class="fu">aes</span>(<span class="at">x=</span>Feather_type, <span class="at">y=</span> Color_index, <span class="at">color=</span>Feather_type, <span class="at">group=</span>Bird))<span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.4</span>), <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.4</span>)) <span class="sc">+</span>  </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span> <span class="st">"Color index"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Feather type"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title=</span><span class="st">"Comparing odd and typical feathers in Northern flickers"</span>)<span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>When this is true, we need to consider these connections.</p>
</section>
<section id="blocking-two-way-anovasand-paired-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="blocking-two-way-anovasand-paired-t-tests">Blocking, two-way ANOVAs,and paired t-tests</h2>
<p>In this case the connections may be considered artifacts of the data. We didn’t assign birds. We also made a choice to compare odd and typical feathers from the same bird - why? In general, accounting for extra variation in the data will give you a better answer about how a given variable influences outcomes. This may be called <em>blocking</em>. Although the motivation might therefore be to get a “better” p value, it should be driven by experimental design (and thus we started with an example where we didn’t “need” to account for it to achieve significance).</p>
<p>In order to consider how color differs by bird <em>and</em> feather type, we need to add both variables to our model. This is possible because, as we noted earlier, we can subdivide variance among multiple levels. For each variable we add, we also add a null (and corresponding alternative) hypothesis. So we retain our focus on feather type:</p>
<p><span class="math display">\[
\begin{split}
H_O: \mu_{\textrm{odd feather color}} = \mu_{\textrm{typical feather color}}\\
H_A: \mu_{\textrm{odd feather color}} \neq \mu_{\textrm{typical feather color}}\\
\end{split}
\]</span></p>
<p>but also add a set of hypotheses focused on birds:</p>
<p><span class="math display">\[
\begin{split}
H_O: \mu_{\textrm{color of bird A}} = \mu_{\textrm{color of bird B}}....\textrm{for all birds}\\
H_A: \mu_{\textrm{color of bird A}} \neq \mu_{\textrm{color of bird B}}....\textrm{for all birds}\\
\end{split}
\]</span></p>
<p>We can analyze this using our linear model approach. Since both variables are categorical, this is often called a two-way ANOVA. First, let’s make the object</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>two_way_anova_example <span class="ot">&lt;-</span> <span class="fu">lm</span>(Color_index <span class="sc">~</span> Feather_type <span class="sc">+</span> Bird, <span class="at">data=</span>feather)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then check the assumptions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(two_way_anova_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note, visually speaking, the residuals do appear to be closer to normal now. Since assumptions look ok, we can analyze the outcome</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(two_way_anova_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Color_index ~ Feather_type + Bird, data = feather)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.12444 -0.05209  0.00000  0.05209  0.12444 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -0.35806    0.06955  -5.148 0.000119 ***
Feather_typeTypical  0.13712    0.03374   4.065 0.001017 ** 
BirdB                0.09050    0.09542   0.948 0.357936    
BirdC                0.04500    0.09542   0.472 0.643998    
BirdD                0.12500    0.09542   1.310 0.209903    
BirdE                0.25350    0.09542   2.657 0.017950 *  
BirdF                0.25750    0.09542   2.699 0.016505 *  
BirdG                0.15000    0.09542   1.572 0.136802    
BirdH                0.25250    0.09542   2.646 0.018330 *  
BirdI                0.28850    0.09542   3.023 0.008554 ** 
BirdJ                0.21500    0.09542   2.253 0.039643 *  
BirdK                0.25300    0.09542   2.651 0.018139 *  
BirdL                0.14450    0.09542   1.514 0.150719    
BirdM                0.13650    0.09542   1.431 0.173069    
BirdN                0.21900    0.09542   2.295 0.036567 *  
BirdO                0.25300    0.09542   2.651 0.018139 *  
BirdP                0.22750    0.09542   2.384 0.030759 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.09542 on 15 degrees of freedom
Multiple R-squared:  0.7304,    Adjusted R-squared:  0.4427 
F-statistic: 2.539 on 16 and 15 DF,  p-value: 0.03923</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(two_way_anova_example, <span class="at">type=</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Color_index
              Sum Sq Df F value   Pr(&gt;F)    
(Intercept)  0.24133  1 26.5059 0.000119 ***
Feather_type 0.15043  1 16.5214 0.001017 ** 
Bird         0.21950 15  1.6072 0.184180    
Residuals    0.13657 15                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Note we see a significant difference in color among birds and feather type. Although we may be tempted to (and could) use post-hoc tests to consider which birds are different than which others, this is typically not done for blocked variables. We did not assign these pairings and it is not the focus of our efforts.</p>
<p>Since we only had 2 types of feathers, we also don’t need post-hoc tests. A significant p value means they differ from each other, and the estimates provided by the <em>summary</em> command indicate the typical feathers have a higher color index.</p>
<section id="t-test-connections" class="level3">
<h3 class="anchored" data-anchor-id="t-test-connections">t-test connections</h3>
<p>When we have only two measurements per group (e.g., odd and typical feathers from each bird), we can use a t-test approach to achieve similar goals. This approach is known as a paired t-test. Instead of focusing on the difference in means (like a 2-sample t-test), the test focuses on the mean difference between paired measurements (which would be 0 under the null hypothesis!). In this way, it is effectively a one-sample test that is pairing the data to reduce variation (blocking). We can do carry out the test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Color_index <span class="sc">~</span> Feather_type, <span class="at">data=</span>feather, <span class="at">paired=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  Color_index by Feather_type
t = -4.0647, df = 15, p-value = 0.001017
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.20903152 -0.06521848
sample estimates:
mean difference 
      -0.137125 </code></pre>
</div>
</div>
<p>and get the same results as above (note we don’t even have to consider corrections like the Welch approach since this a one-sample test). Common examples of paired t-tests include before-after and twin studies.</p>
<p>In an earlier chapters we considered options for one- and two-sample tests when t-tests assumptions were not met. For two-sample tests, one of these approaches, the sign or binary test, is only valid for paired data. The differences in paired observations are compared to a set value (typically 0). Under the null hypothesis, half should be below the proposed median and half should be above. Differences matching the proposed value are ignored, thus reducing the sample size and making it harder to reject the null hypothesis; this is actually an odd way of accounting for them. The proportion of values below the proposed median is then evaluated using a binomial test. For two sample, the <em>SIGN.test</em> function in the <strong>BSDA</strong> package requires 2 columns of data and assumes the order of the column represents paired data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BSDA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'BSDA'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:carData':

    Vocab, Wool</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:datasets':

    Orange</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SIGN.test</span>(feather[feather<span class="sc">$</span>Feather_type <span class="sc">==</span> <span class="st">"Odd"</span>, <span class="st">"Color_index"</span>], </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>          feather[feather<span class="sc">$</span>Feather_type <span class="sc">==</span> <span class="st">"Typical"</span>, <span class="st">"Color_index"</span>],</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">md =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Dependent-samples Sign-Test

data:  feather[feather$Feather_type == "Odd", "Color_index"] and feather[feather$Feather_type == "Typical", "Color_index"]
S = 3, p-value = 0.02127
alternative hypothesis: true median difference is not equal to 0
95 percent confidence interval:
 -0.24048275 -0.02331055
sample estimates:
median of x-y 
       -0.114 

Achieved and Interpolated Confidence Intervals: 

                  Conf.Level  L.E.pt  U.E.pt
Lower Achieved CI     0.9232 -0.2400 -0.0320
Interpolated CI       0.9500 -0.2405 -0.0233
Upper Achieved CI     0.9787 -0.2410 -0.0140</code></pre>
</div>
</div>
</section>
<section id="more-than-2-measurements-back-to-the-linear-model" class="level3">
<h3 class="anchored" data-anchor-id="more-than-2-measurements-back-to-the-linear-model">More than 2 measurements? Back to the linear model</h3>
<p>We can also block for variation when we take more than 2 measurements per unit. For example, imagine if these birds also had a special, long tail feather.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>special <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Bird =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>], <span class="at">Feather_type =</span> <span class="st">"Special"</span>, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Color_index=</span> feather[feather<span class="sc">$</span>Feather_type <span class="sc">==</span> <span class="st">"Typical"</span>, <span class="st">"Color_index"</span>] <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                        .<span class="dv">3</span> <span class="sc">+</span><span class="fu">runif</span>(<span class="dv">16</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span>.<span class="dv">01</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>feather_extra <span class="ot">&lt;-</span> <span class="fu">merge</span>(feather, special, <span class="at">all =</span> T)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>feather_extra<span class="sc">$</span>Feather_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(feather_extra<span class="sc">$</span>Feather_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We could still block for variation using the linear model/ANOVA, but not the t-test, approach. As another review, we create the model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>more_blocks <span class="ot">&lt;-</span><span class="fu">lm</span>(Color_index <span class="sc">~</span> Feather_type <span class="sc">+</span> Bird, <span class="at">data=</span>feather_extra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check assumptions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(more_blocks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-15-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Check outcome (this time focusing on <em>Anova</em> output)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(more_blocks, <span class="at">type=</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Color_index
              Sum Sq Df  F value    Pr(&gt;F)    
(Intercept)  0.36392  1  59.9538 1.224e-08 ***
Feather_type 1.67906  2 138.3093 7.208e-16 ***
Bird         0.34649 15   3.8055 0.0008969 ***
Residuals    0.18210 30                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We still see feather type has a significant impact on color, but since we have more than 2 groups we need to follow up this finding with a post-hoc test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: mvtnorm</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: survival</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: TH.data</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'TH.data'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    geyser</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>compare <span class="ot">&lt;-</span> <span class="fu">glht</span>(more_blocks, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">Feather_type =</span> <span class="st">"Tukey"</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(compare)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = Color_index ~ Feather_type + Bird, data = feather_extra)

Linear Hypotheses:
                       Estimate Std. Error t value Pr(&gt;|t|)    
Special - Odd == 0      0.44713    0.02755  16.232   &lt;1e-04 ***
Typical - Odd == 0      0.13713    0.02755   4.978   &lt;1e-04 ***
Typical - Special == 0 -0.31000    0.02755 -11.254   &lt;1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
</section>
</section>
<section id="other-ways-to-be-in-multiple-groups" class="level2">
<h2 class="anchored" data-anchor-id="other-ways-to-be-in-multiple-groups">Other ways to be in multiple groups</h2>
<p>In the bird example, one of our categories (bird) was un-intential. We chose to measure odd and typical feathers, and accounting for variation among birds was an appropriate step given lack of independece in measurements. However, we can also assign units to multiple groups. Doing so can let us consider the <strong>main effects</strong> of multiple variables and potential <strong>interactions</strong> among them in what is often called a <strong>factorial ANOVA</strong>.</p>
<p>For example, <span class="citation" data-cites="valdez2023">Valdez et al. (<a href="#ref-valdez2023" role="doc-biblioref">2023</a>)</span> wanted to consider the impact of top-down (snail grazing) and bottom- up (nutrient availability) on marsh plant (<em>Spartina alterniflora</em>) growth. To do this, they assigned plots to one of 3 grazer treatments and one of 2 nitrogen treatments.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0286327"><img src="../..\images/journal.pone.0286327.g001.PNG" class="img-fluid figure-img" alt="Map of study site on Hog Island, Virginia, USA and conceptual illustration of experimental design with the following treatments: 1) Nitrogen addition with ambient snails, 2) nitrogen addition with three times ambient snails, 3) nitrogen addition without snails, 4) ambient nitrogen with ambient snails, 5) ambient nitrogen with three times ambient snails, and 6) ambient nitrogen without snails. The figure also depicts cage controls and uncaged plots used to assess caging effects on marsh plants. The map in the figure was created in R using ggmap [33] from ©OpenStreetMap under a ODb license, with permission from OpenStreetMapFoundation, original copyright 2018. https://www.openstreetmap.org/copyright."></a></p>
<figcaption class="figure-caption">Fig 1 from Valdez et al.&nbsp;2003. Map and conceptual illustration of experimental design.</figcaption>
</figure>
</div>
<p>This design is different from the bird example. No two measurements for a given trait were taken on the same plot. In this case, we likely care about the main effects, or impacts, of both variables. However, we may also need to consider interactions among the variables. Interactions occur when the impact of one variable depends on the level of another. For example, snail removal might have major impacts on nitrogen-enriched plots while having no impact on ambient plots. Due to this, we now have even more hypotheses:</p>
<p><span class="math display">\[
\begin{split}
H_O: \mu_\textrm{plant growth, no fertilizer} = \mu_\textrm{plant growth, fertilizer}\\
H_O: \mu_\textrm{plant growth, snails removed} = \mu_\textrm{plant growth, control snails}= \mu_\textrm{plant growth, snails added}\\
H_O: \textrm{impact of snail grazing does not depend on nitrogen level}\\
\end{split}
\]</span></p>
<p>Fortunately, these are easy to consider in our linear model framework. We simply add the interaction between two variables using the “:” notation. We’ll focus on below-ground biomass (standardized to m<sup>2</sup>) for this example (the paper measured 9 response variables!)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>valdez_2023 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/Spartina_alterniflora_traits.csv"</span>, <span class="at">stringsAsFactors =</span> T)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>bgb_model <span class="ot">&lt;-</span><span class="fu">lm</span>(below.biomass.g.meter.sq..m2..<span class="sc">~</span>Snail.Level <span class="sc">+</span> Nitrogen.level <span class="sc">+</span> Snail.Level<span class="sc">:</span>Nitrogen.level, valdez_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For shorthand, note that if we put <em>main effect * main effect</em> in a model, it automatically adds the interaction term.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>bgb_model_shorthand <span class="ot">&lt;-</span><span class="fu">lm</span>(below.biomass.g.meter.sq..m2..<span class="sc">~</span>Snail.Level <span class="sc">*</span> Nitrogen.level, valdez_2023)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bgb_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = below.biomass.g.meter.sq..m2.. ~ Snail.Level + Nitrogen.level + 
    Snail.Level:Nitrogen.level, data = valdez_2023)

Residuals:
     Min       1Q   Median       3Q      Max 
-103.003  -50.933    1.507   28.297  153.937 

Coefficients: (1 not defined because of singularities)
                                                Estimate Std. Error t value
(Intercept)                                       542.16      40.72  13.315
Snail.Levelremoval                                 33.58      57.58   0.583
Snail.Levelsnail addition                         -88.85      57.58  -1.543
Snail.Leveluncaged                                 45.09      57.58   0.783
Nitrogen.levelwithout                            -111.87      57.58  -1.943
Snail.Levelremoval:Nitrogen.levelwithout           43.39      81.44   0.533
Snail.Levelsnail addition:Nitrogen.levelwithout    60.18      81.44   0.739
Snail.Leveluncaged:Nitrogen.levelwithout              NA         NA      NA
                                                Pr(&gt;|t|)    
(Intercept)                                     2.44e-09 ***
Snail.Levelremoval                                0.5691    
Snail.Levelsnail addition                         0.1451    
Snail.Leveluncaged                                0.4467    
Nitrogen.levelwithout                             0.0724 .  
Snail.Levelremoval:Nitrogen.levelwithout          0.6025    
Snail.Levelsnail addition:Nitrogen.levelwithout   0.4721    
Snail.Leveluncaged:Nitrogen.levelwithout              NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 70.53 on 14 degrees of freedom
Multiple R-squared:  0.498, Adjusted R-squared:  0.2829 
F-statistic: 2.315 on 6 and 14 DF,  p-value: 0.09183</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bgb_model_shorthand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = below.biomass.g.meter.sq..m2.. ~ Snail.Level * Nitrogen.level, 
    data = valdez_2023)

Residuals:
     Min       1Q   Median       3Q      Max 
-103.003  -50.933    1.507   28.297  153.937 

Coefficients: (1 not defined because of singularities)
                                                Estimate Std. Error t value
(Intercept)                                       542.16      40.72  13.315
Snail.Levelremoval                                 33.58      57.58   0.583
Snail.Levelsnail addition                         -88.85      57.58  -1.543
Snail.Leveluncaged                                 45.09      57.58   0.783
Nitrogen.levelwithout                            -111.87      57.58  -1.943
Snail.Levelremoval:Nitrogen.levelwithout           43.39      81.44   0.533
Snail.Levelsnail addition:Nitrogen.levelwithout    60.18      81.44   0.739
Snail.Leveluncaged:Nitrogen.levelwithout              NA         NA      NA
                                                Pr(&gt;|t|)    
(Intercept)                                     2.44e-09 ***
Snail.Levelremoval                                0.5691    
Snail.Levelsnail addition                         0.1451    
Snail.Leveluncaged                                0.4467    
Nitrogen.levelwithout                             0.0724 .  
Snail.Levelremoval:Nitrogen.levelwithout          0.6025    
Snail.Levelsnail addition:Nitrogen.levelwithout   0.4721    
Snail.Leveluncaged:Nitrogen.levelwithout              NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 70.53 on 14 degrees of freedom
Multiple R-squared:  0.498, Adjusted R-squared:  0.2829 
F-statistic: 2.315 on 6 and 14 DF,  p-value: 0.09183</code></pre>
</div>
</div>
<p>You may note a weird NA here (we’ll come back to it) but we should really check model assumptions before looking at output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bgb_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-20-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These look ok. There may be a slight increase in variance with fitted values, but we can work with this. Let’s return to our summary and build an ANOVA table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bgb_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = below.biomass.g.meter.sq..m2.. ~ Snail.Level + Nitrogen.level + 
    Snail.Level:Nitrogen.level, data = valdez_2023)

Residuals:
     Min       1Q   Median       3Q      Max 
-103.003  -50.933    1.507   28.297  153.937 

Coefficients: (1 not defined because of singularities)
                                                Estimate Std. Error t value
(Intercept)                                       542.16      40.72  13.315
Snail.Levelremoval                                 33.58      57.58   0.583
Snail.Levelsnail addition                         -88.85      57.58  -1.543
Snail.Leveluncaged                                 45.09      57.58   0.783
Nitrogen.levelwithout                            -111.87      57.58  -1.943
Snail.Levelremoval:Nitrogen.levelwithout           43.39      81.44   0.533
Snail.Levelsnail addition:Nitrogen.levelwithout    60.18      81.44   0.739
Snail.Leveluncaged:Nitrogen.levelwithout              NA         NA      NA
                                                Pr(&gt;|t|)    
(Intercept)                                     2.44e-09 ***
Snail.Levelremoval                                0.5691    
Snail.Levelsnail addition                         0.1451    
Snail.Leveluncaged                                0.4467    
Nitrogen.levelwithout                             0.0724 .  
Snail.Levelremoval:Nitrogen.levelwithout          0.6025    
Snail.Levelsnail addition:Nitrogen.levelwithout   0.4721    
Snail.Leveluncaged:Nitrogen.levelwithout              NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 70.53 on 14 degrees of freedom
Multiple R-squared:  0.498, Adjusted R-squared:  0.2829 
F-statistic: 2.315 on 6 and 14 DF,  p-value: 0.09183</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(bgb_model, <span class="at">type=</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in Anova.III.lm(mod, error, singular.ok = singular.ok, ...): there are aliased coefficients in the model</code></pre>
</div>
</div>
<p>But we got an error! What happened? Let’s look at the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paged_table</span>(valdez_2023)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Snail.Level"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Nitrogen.level"],"name":[2],"type":["fct"],"align":["left"]},{"label":["below.biomass..g."],"name":[3],"type":["dbl"],"align":["right"]},{"label":["below.biomass.g.meter.sq..m2.."],"name":[4],"type":["dbl"],"align":["right"]},{"label":["above.ground.biomass..g."],"name":[5],"type":["dbl"],"align":["right"]},{"label":["above.ground.biomass..g.m2."],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Radulations..cm.stem."],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Percent.Organic.content.of.Soil"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Standing.Dead..dry..m2."],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Leaf.Litter..dry.wt.per.0.25m2."],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Leaf.litter..dry.weight..m2."],"name":[11],"type":["dbl"],"align":["right"]},{"label":["X..flowering..m2"],"name":[12],"type":["int"],"align":["right"]},{"label":["Shoot.density..m2"],"name":[13],"type":["int"],"align":["right"]},{"label":["X..flowering..m2.1"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["X..new.shoots.sample.Aug"],"name":[15],"type":["int"],"align":["right"]},{"label":["X..new.shoots..sample.Sept"],"name":[16],"type":["int"],"align":["right"]},{"label":["X.new.shoots..m2.Aug"],"name":[17],"type":["int"],"align":["right"]},{"label":["X.new.shoots..m2.Sept"],"name":[18],"type":["int"],"align":["right"]},{"label":["Mean.new.shoot.length..cm..Aug"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["Mean.new.shoot.length..cm..Sept"],"name":[20],"type":["dbl"],"align":["right"]}],"data":[{"1":"removal","2":"without","3":"7.92","4":"448.22","5":"14.96","6":"846.63","7":"0.004","8":"0.080","9":"5.47","10":"0.500","11":"2.000","12":"28","13":"256","14":"0.109","15":"12","16":"26","17":"192","18":"416","19":"5.408","20":"7.269"},{"1":"removal","2":"without","3":"10.00","4":"565.93","5":"21.30","6":"1205.43","7":"0.003","8":"0.069","9":"6.89","10":"0.751","11":"3.004","12":"26","13":"256","14":"0.102","15":"15","16":"41","17":"240","18":"656","19":"5.973","20":"7.853"},{"1":"removal","2":"without","3":"8.97","4":"507.64","5":"16.54","6":"935.94","7":"0.002","8":"0.062","9":"4.06","10":"0.830","11":"3.320","12":"22","13":"208","14":"0.106","15":"14","16":"19","17":"224","18":"304","19":"6.564","20":"9.300"},{"1":"control snails","2":"without","3":"6.37","4":"360.50","5":"12.21","6":"690.89","7":"0.398","8":"0.064","9":"3.41","10":"0.030","11":"0.120","12":"8","13":"192","14":"0.042","15":"8","16":"19","17":"128","18":"304","19":"3.350","20":"6.174"},{"1":"control snails","2":"without","3":"8.56","4":"484.44","5":"14.12","6":"798.81","7":"0.650","8":"0.057","9":"4.50","10":"0.060","11":"0.240","12":"13","13":"208","14":"0.063","15":"10","16":"23","17":"160","18":"368","19":"3.980","20":"5.843"},{"1":"control snails","2":"without","3":"7.88","4":"445.95","5":"15.85","6":"897.00","7":"0.155","8":"0.043","9":"2.50","10":"0.070","11":"0.280","12":"9","13":"208","14":"0.043","15":"9","16":"10","17":"144","18":"160","19":"5.789","20":"10.340"},{"1":"snail addition","2":"without","3":"6.89","4":"389.93","5":"5.96","6":"337.29","7":"1.060","8":"0.083","9":"6.58","10":"0.210","11":"0.840","12":"3","13":"160","14":"0.019","15":"5","16":"16","17":"80","18":"256","19":"5.040","20":"6.969"},{"1":"snail addition","2":"without","3":"7.09","4":"401.25","5":"8.15","6":"461.23","7":"1.201","8":"0.061","9":"5.20","10":"0.080","11":"0.320","12":"4","13":"176","14":"0.023","15":"6","16":"13","17":"96","18":"208","19":"5.400","20":"6.715"},{"1":"snail addition","2":"without","3":"7.31","4":"413.70","5":"6.35","6":"359.37","7":"0.126","8":"0.061","9":"7.00","10":"0.150","11":"0.600","12":"1","13":"112","14":"0.009","15":"3","16":"8","17":"48","18":"128","19":"4.267","20":"6.513"},{"1":"removal","2":"Fertilized","3":"10.43","4":"590.27","5":"89.40","6":"5059.42","7":"0.013","8":"0.060","9":"4.57","10":"0.140","11":"0.560","12":"68","13":"336","14":"0.202","15":"24","16":"30","17":"384","18":"480","19":"8.200","20":"7.983"},{"1":"removal","2":"Fertilized","3":"9.89","4":"559.71","5":"82.71","6":"4680.76","7":"0.006","8":"0.061","9":"4.13","10":"0.120","11":"0.480","12":"44","13":"304","14":"0.145","15":"17","16":"27","17":"272","18":"432","19":"8.971","20":"8.797"},{"1":"removal","2":"Fertilized","3":"10.20","4":"577.25","5":"95.25","6":"5390.21","7":"0.005","8":"0.056","9":"4.98","10":"0.050","11":"0.200","12":"56","13":"320","14":"0.175","15":"31","16":"38","17":"496","18":"608","19":"8.810","20":"10.563"},{"1":"control snails","2":"Fertilized","3":"8.68","4":"491.23","5":"48.79","6":"2761.18","7":"1.444","8":"0.062","9":"15.13","10":"0.200","11":"0.800","12":"30","13":"272","14":"0.110","15":"9","16":"15","17":"144","18":"240","19":"5.933","20":"11.720"},{"1":"control snails","2":"Fertilized","3":"7.76","4":"439.16","5":"55.74","6":"3154.50","7":"1.187","8":"0.056","9":"18.55","10":"0.670","11":"2.680","12":"12","13":"224","14":"0.054","15":"15","16":"31","17":"240","18":"496","19":"7.920","20":"12.870"},{"1":"control snails","2":"Fertilized","3":"12.30","4":"696.10","5":"55.97","6":"3167.40","7":"0.158","8":"0.052","9":"22.45","10":"0.220","11":"0.880","12":"20","13":"272","14":"0.074","15":"10","16":"24","17":"160","18":"384","19":"11.220","20":"12.354"},{"1":"snail addition","2":"Fertilized","3":"6.80","4":"384.83","5":"12.30","6":"696.10","7":"1.840","8":"0.060","9":"12.49","10":"0.400","11":"1.600","12":"1","13":"144","14":"0.007","15":"14","16":"14","17":"224","18":"224","19":"7.036","20":"13.536"},{"1":"snail addition","2":"Fertilized","3":"8.40","4":"475.38","5":"23.40","6":"1324.28","7":"2.198","8":"0.055","9":"11.05","10":"0.440","11":"1.760","12":"10","13":"208","14":"0.048","15":"15","16":"19","17":"240","18":"304","19":"7.647","20":"9.494"},{"1":"snail addition","2":"Fertilized","3":"8.83","4":"499.72","5":"17.01","6":"962.42","7":"0.219","8":"0.062","9":"9.89","10":"0.320","11":"1.280","12":"8","13":"144","14":"0.056","15":"26","16":"28","17":"416","18":"448","19":"7.273","20":"9.932"},{"1":"uncaged","2":"without","3":"7.00","4":"396.15","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"9","13":"NA","14":"NA","15":"9","16":"21","17":"144","18":"336","19":"6.433","20":"8.533"},{"1":"uncaged","2":"without","3":"9.30","4":"526.32","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"6","13":"NA","14":"NA","15":"10","16":"20","17":"160","18":"320","19":"6.620","20":"9.105"},{"1":"uncaged","2":"without","3":"8.90","4":"503.68","5":"NA","6":"NA","7":"NA","8":"NA","9":"NA","10":"NA","11":"NA","12":"8","13":"NA","14":"NA","15":"9","16":"21","17":"144","18":"336","19":"5.611","20":"7.914"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>A summary may help more. Note we can summarize across multiple factors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: plyr</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarySE</span>(valdez_2023, <span class="at">measurevar =</span> <span class="st">"below.biomass.g.meter.sq..m2.."</span>, <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">"Snail.Level"</span>, <span class="st">"Nitrogen.level"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Snail.Level Nitrogen.level N below.biomass.g.meter.sq..m2..        sd
1 control snails     Fertilized 3                       542.1633 135.83149
2 control snails        without 3                       430.2967  63.43541
3        removal     Fertilized 3                       575.7433  15.33561
4        removal        without 3                       507.2633  58.85590
5 snail addition     Fertilized 3                       453.3100  60.54124
6 snail addition        without 3                       401.6267  11.88948
7        uncaged        without 3                       475.3833  69.54555
         se        ci
1 78.422349 337.42413
2 36.624450 157.58229
3  8.854019  38.09577
4 33.980472 146.20617
5 34.953501 150.39278
6  6.864392  29.53510
7 40.152141 172.76072</code></pre>
</div>
</div>
<p>Note the <em>uncaged</em> treatment only has <em>without</em> for the nitrogen impact. It was a control! While we often need these in experiments, they can create analysis problems. This is because we can’t consider how nutrient level depends on snail treatment for the control level! You could note we have the same issue for our initial bird analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>two_way_anova_example_int <span class="ot">&lt;-</span> <span class="fu">lm</span>(Color_index <span class="sc">~</span> Feather_type <span class="sc">*</span> Bird, <span class="at">data=</span>feather)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(two_way_anova_example_int, <span class="at">type=</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in Anova.lm(two_way_anova_example_int, type = "III"): residual df = 0</code></pre>
</div>
</div>
<p>On a positive note, this means R will typically not consider interactions when it shouldn’t, but you need to know why in order to fix it.</p>
<p>The NAs in the model summary</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bgb_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = below.biomass.g.meter.sq..m2.. ~ Snail.Level + Nitrogen.level + 
    Snail.Level:Nitrogen.level, data = valdez_2023)

Residuals:
     Min       1Q   Median       3Q      Max 
-103.003  -50.933    1.507   28.297  153.937 

Coefficients: (1 not defined because of singularities)
                                                Estimate Std. Error t value
(Intercept)                                       542.16      40.72  13.315
Snail.Levelremoval                                 33.58      57.58   0.583
Snail.Levelsnail addition                         -88.85      57.58  -1.543
Snail.Leveluncaged                                 45.09      57.58   0.783
Nitrogen.levelwithout                            -111.87      57.58  -1.943
Snail.Levelremoval:Nitrogen.levelwithout           43.39      81.44   0.533
Snail.Levelsnail addition:Nitrogen.levelwithout    60.18      81.44   0.739
Snail.Leveluncaged:Nitrogen.levelwithout              NA         NA      NA
                                                Pr(&gt;|t|)    
(Intercept)                                     2.44e-09 ***
Snail.Levelremoval                                0.5691    
Snail.Levelsnail addition                         0.1451    
Snail.Leveluncaged                                0.4467    
Nitrogen.levelwithout                             0.0724 .  
Snail.Levelremoval:Nitrogen.levelwithout          0.6025    
Snail.Levelsnail addition:Nitrogen.levelwithout   0.4721    
Snail.Leveluncaged:Nitrogen.levelwithout              NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 70.53 on 14 degrees of freedom
Multiple R-squared:  0.498, Adjusted R-squared:  0.2829 
F-statistic: 2.315 on 6 and 14 DF,  p-value: 0.09183</code></pre>
</div>
</div>
<p>Occur for the same reason. Interactions can not be calculated for some levels.</p>
<p>To fix this (and deal with controls), we need to consider the data. <span class="citation" data-cites="valdez2023">Valdez et al. (<a href="#ref-valdez2023" role="doc-biblioref">2023</a>)</span> used t-tests (why?) to consider differences between cage and cage control plots (note %in% and the fact they did not focus on above-ground biomass (maybe because uncaged plots had little..).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>?<span class="st">'%in%'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>starting httpd help server ... done</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(below.biomass.g.meter.sq..m2..<span class="sc">~</span>Snail.Level, valdez_2023[valdez_2023<span class="sc">$</span>Snail.Level <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"uncaged"</span>,<span class="st">"control snails"</span>) <span class="sc">&amp;</span> valdez_2023<span class="sc">$</span>Nitrogen.level <span class="sc">==</span> <span class="st">"without"</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  below.biomass.g.meter.sq..m2.. by Snail.Level
t = -0.82961, df = 3.9666, p-value = 0.4538
alternative hypothesis: true difference in means between group control snails and group uncaged is not equal to 0
95 percent confidence interval:
 -196.4785  106.3052
sample estimates:
mean in group control snails        mean in group uncaged 
                    430.2967                     475.3833 </code></pre>
</div>
</div>
<p>To consider interactions, we can remove the controls</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>bgb_model_cont_removed <span class="ot">&lt;-</span><span class="fu">lm</span>(below.biomass.g.meter.sq..m2..<span class="sc">~</span>Snail.Level <span class="sc">+</span> Nitrogen.level <span class="sc">+</span> Snail.Level<span class="sc">:</span>Nitrogen.level, valdez_2023[valdez_2023<span class="sc">$</span>Snail.Level <span class="sc">!=</span> <span class="st">"uncaged"</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can consider the assumptions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bgb_model_cont_removed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-29-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>and now note …</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(bgb_model_cont_removed, <span class="at">type=</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: below.biomass.g.meter.sq..m2..
                           Sum Sq Df  F value    Pr(&gt;F)    
(Intercept)                881823  1 176.4820 1.545e-08 ***
Snail.Level                 24012  2   2.4028   0.13254    
Nitrogen.level              18771  1   3.7567   0.07648 .  
Snail.Level:Nitrogen.level   2893  2   0.2895   0.75371    
Residuals                   59960 12                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>…that the ANOVA table works.</p>
<section id="intepreting-interactions" class="level3">
<h3 class="anchored" data-anchor-id="intepreting-interactions">Intepreting interactions</h3>
<section id="when-not-significant" class="level4">
<h4 class="anchored" data-anchor-id="when-not-significant">When not significant</h4>
<p>If interactions are not significant, they can be handled in 2 ways.</p>
<ol type="1">
<li><p>We can remove the interaction from the model, re-run it, and interpret main effect</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>bgb_model_cont_removed_int_removed <span class="ot">&lt;-</span> <span class="fu">update</span>(bgb_model_cont_removed, .<span class="sc">~</span>.<span class="sc">-</span>Snail.Level<span class="sc">:</span>Nitrogen.level)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(bgb_model_cont_removed_int_removed, <span class="at">type=</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: below.biomass.g.meter.sq..m2..
                Sum Sq Df  F value    Pr(&gt;F)    
(Intercept)    1239848  1 276.1645 1.303e-10 ***
Snail.Level      39024  2   4.3461   0.03402 *  
Nitrogen.level   26919  1   5.9959   0.02812 *  
Residuals        62853 14                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div></li>
<li><p>We can leave the interaction in the model and interpret main effects immediately</p></li>
</ol>
<p>The benefit of approach 1 is we “increase” the degrees of freedom associated with the residuals, which ends up reducing the the MST. This is because in 2-way ANOVA’s we allocate degrees of freedom to calculating main effects and interactions. This approach was likely used in the original manuscript.</p>
<p>The second approach is to simply use the provided output and not perform another series of tests, which may increase chances for a Type 1 error. We will return to this discussion when we get to model selection.</p>
<p>Regardless, we can interpret main effects (though with possibly different outcomes). Using the approach were we drop insignificant interactions, we see both nitrogen and grazing levels impact below ground biomass. Since there are 3 levels of grazing and no interactions, we can consider the general impact of grazing levels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(bgb_model_cont_removed_int_removed, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">Snail.Level =</span> <span class="st">"Tukey"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = below.biomass.g.meter.sq..m2.. ~ Snail.Level + Nitrogen.level, 
    data = valdez_2023[valdez_2023$Snail.Level != "uncaged", 
        ])

Linear Hypotheses:
                                     Estimate Std. Error t value Pr(&gt;|t|)  
removal - control snails == 0           55.27      38.68   1.429   0.3536  
snail addition - control snails == 0   -58.76      38.68  -1.519   0.3123  
snail addition - removal == 0         -114.03      38.68  -2.948   0.0269 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
</section>
<section id="when-significant" class="level4">
<h4 class="anchored" data-anchor-id="when-significant">When significant</h4>
<p>If the interaction term is significant, it means the main effects can not be interpreted. This is because the impact of a given variable depends on the level of another. When this happens, the data is typically divided into subset and analyzed using one-way ANOVAs. Another less-used approach is to interpret interaction terms.</p>
<p>For example, when <span class="citation" data-cites="valdez2023">Valdez et al. (<a href="#ref-valdez2023" role="doc-biblioref">2023</a>)</span> analyzed standing dead mass, they found a significant interaction term:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>sdm_model <span class="ot">&lt;-</span><span class="fu">lm</span>(Standing.Dead..dry..m2.<span class="sc">~</span>Snail.Level <span class="sc">*</span> Nitrogen.level, valdez_2023[valdez_2023<span class="sc">$</span>Snail.Level <span class="sc">!=</span> <span class="st">"uncaged"</span>,])</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sdm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-33-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(sdm_model, <span class="at">type=</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Standing.Dead..dry..m2.
                            Sum Sq Df F value    Pr(&gt;F)    
(Intercept)                1050.19  1 328.463 4.392e-10 ***
Snail.Level                 300.82  2  47.042 2.095e-06 ***
Nitrogen.level              348.39  1 108.963 2.248e-07 ***
Snail.Level:Nitrogen.level  200.90  2  31.417 1.700e-05 ***
Residuals                    38.37 12                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Following this, you could investigate impacts in plots with nitrogen, where you find snail manipulation had a significant impact,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>sdm_model_fertilized <span class="ot">&lt;-</span><span class="fu">lm</span>(Standing.Dead..dry..m2.<span class="sc">~</span>Snail.Level, valdez_2023[valdez_2023<span class="sc">$</span>Snail.Level <span class="sc">!=</span> <span class="st">"uncaged"</span> <span class="sc">&amp;</span> valdez_2023<span class="sc">$</span>Nitrogen.level <span class="sc">==</span> <span class="st">"Fertilized"</span>,])</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sdm_model_fertilized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-34-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(sdm_model_fertilized, <span class="at">type=</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Standing.Dead..dry..m2.
             Sum Sq Df F value    Pr(&gt;F)    
(Intercept) 1050.19  1 206.027 7.158e-06 ***
Snail.Level  300.82  2  29.507  0.000786 ***
Residuals     30.58  6                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(sdm_model_fertilized, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">Snail.Level=</span> <span class="st">"Tukey"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = Standing.Dead..dry..m2. ~ Snail.Level, data = valdez_2023[valdez_2023$Snail.Level != 
    "uncaged" &amp; valdez_2023$Nitrogen.level == "Fertilized", ])

Linear Hypotheses:
                                     Estimate Std. Error t value Pr(&gt;|t|)    
removal - control snails == 0         -14.150      1.843  -7.676   &lt;0.001 ***
snail addition - control snails == 0   -7.567      1.843  -4.105   0.0152 *  
snail addition - removal == 0           6.583      1.843   3.571   0.0272 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
<p>and plots without added nutrients, where you find snail addition did not</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>sdm_model_not_fertilized <span class="ot">&lt;-</span><span class="fu">lm</span>(Standing.Dead..dry..m2.<span class="sc">~</span>Snail.Level, valdez_2023[valdez_2023<span class="sc">$</span>Snail.Level <span class="sc">!=</span> <span class="st">"uncaged"</span> <span class="sc">&amp;</span> valdez_2023<span class="sc">$</span>Nitrogen.level <span class="sc">==</span> <span class="st">"without"</span>,])</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sdm_model_not_fertilized)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-35-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-35-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(sdm_model_not_fertilized, <span class="at">type=</span> <span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Standing.Dead..dry..m2.
            Sum Sq Df F value   Pr(&gt;F)   
(Intercept) 36.123  1 27.8457 0.001871 **
Snail.Level 12.416  2  4.7856 0.057211 . 
Residuals    7.783  6                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Since interactions were significant, we could also choose to compare all groups. the <strong>emmeans</strong> package offers this approach (and was likely used in the Valdez et al.&nbsp;2023 paper).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'emmeans' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(sdm_model, pairwise <span class="sc">~</span> Snail.Level<span class="sc">*</span>Nitrogen.level)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 Snail.Level    Nitrogen.level emmean   SE df lower.CL upper.CL
 control snails Fertilized      18.71 1.03 12    16.46    20.96
 removal        Fertilized       4.56 1.03 12     2.31     6.81
 snail addition Fertilized      11.14 1.03 12     8.89    13.39
 control snails without          3.47 1.03 12     1.22     5.72
 removal        without          5.47 1.03 12     3.22     7.72
 snail addition without          6.26 1.03 12     4.01     8.51

Confidence level used: 0.95 

$contrasts
 contrast                                              estimate   SE df t.ratio
 control snails Fertilized - removal Fertilized          14.150 1.46 12   9.692
 control snails Fertilized - snail addition Fertilized    7.567 1.46 12   5.183
 control snails Fertilized - control snails without      15.240 1.46 12  10.439
 control snails Fertilized - removal without             13.237 1.46 12   9.066
 control snails Fertilized - snail addition without      12.450 1.46 12   8.528
 removal Fertilized - snail addition Fertilized          -6.583 1.46 12  -4.509
 removal Fertilized - control snails without              1.090 1.46 12   0.747
 removal Fertilized - removal without                    -0.913 1.46 12  -0.626
 removal Fertilized - snail addition without             -1.700 1.46 12  -1.164
 snail addition Fertilized - control snails without       7.673 1.46 12   5.256
 snail addition Fertilized - removal without              5.670 1.46 12   3.884
 snail addition Fertilized - snail addition without       4.883 1.46 12   3.345
 control snails without - removal without                -2.003 1.46 12  -1.372
 control snails without - snail addition without         -2.790 1.46 12  -1.911
 removal without - snail addition without                -0.787 1.46 12  -0.539
 p.value
  &lt;.0001
  0.0024
  &lt;.0001
  &lt;.0001
  &lt;.0001
  0.0072
  0.9716
  0.9868
  0.8450
  0.0021
  0.0206
  0.0512
  0.7419
  0.4406
  0.9932

P value adjustment: tukey method for comparing a family of 6 estimates </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="other-options" class="level2">
<h2 class="anchored" data-anchor-id="other-options">Other options</h2>
<p>Bootstrapping and permutation tests options may also be used for two-way ANOVAs when assumptions are not met, though there is implementation is more complicated than single-sample designs due to the need to randomize/permute interaction impacts.</p>
<p>Another option is to use weighted-least squares regression - this approach specifically helps when residuals are not evenly distributed among groups. For example, we could take the sdm_model (just as an example of use! it’s not needed here!) This approach assume you built the model and then noted an issue with heteroscedasticity. If so, we can calculate a weight for each residual that is based on its variance - below makes a value that increases with low variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>wt_sdm <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">lm</span>(<span class="fu">abs</span>(sdm_model<span class="sc">$</span>residuals) <span class="sc">~</span> sdm_model<span class="sc">$</span>fitted.values)<span class="sc">$</span>fitted.values<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then add a new argument to the <em>lm</em> function to use these weights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>sdm_model_wls <span class="ot">&lt;-</span><span class="fu">lm</span>(Standing.Dead..dry..m2.<span class="sc">~</span>Snail.Level <span class="sc">*</span> Nitrogen.level, valdez_2023[valdez_2023<span class="sc">$</span>Snail.Level <span class="sc">!=</span> <span class="st">"uncaged"</span>,], <span class="at">weights =</span> wt_sdm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then continue on our normal route:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sdm_model_wls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-39-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-39-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-39-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(sdm_model_wls, <span class="at">type=</span><span class="st">"III"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Standing.Dead..dry..m2.
                            Sum Sq Df F value    Pr(&gt;F)    
(Intercept)                203.228  1  76.442 1.497e-06 ***
Snail.Level                157.447  2  29.611 2.288e-05 ***
Nitrogen.level             130.416  1  49.054 1.427e-05 ***
Snail.Level:Nitrogen.level 143.013  2  26.896 3.681e-05 ***
Residuals                   31.903 12                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>If you compare the two models you notice slight differences - these are minimal here due to lack of differences in variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sdm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Standing.Dead..dry..m2. ~ Snail.Level * Nitrogen.level, 
    data = valdez_2023[valdez_2023$Snail.Level != "uncaged", 
        ])

Residuals:
    Min      1Q  Median      3Q     Max 
-3.5800 -0.8350 -0.0317  0.6600  3.7400 

Coefficients:
                                                Estimate Std. Error t value
(Intercept)                                       18.710      1.032  18.124
Snail.Levelremoval                               -14.150      1.460  -9.692
Snail.Levelsnail addition                         -7.567      1.460  -5.183
Nitrogen.levelwithout                            -15.240      1.460 -10.439
Snail.Levelremoval:Nitrogen.levelwithout          16.153      2.065   7.824
Snail.Levelsnail addition:Nitrogen.levelwithout   10.357      2.065   5.016
                                                Pr(&gt;|t|)    
(Intercept)                                     4.39e-10 ***
Snail.Levelremoval                              5.02e-07 ***
Snail.Levelsnail addition                       0.000228 ***
Nitrogen.levelwithout                           2.25e-07 ***
Snail.Levelremoval:Nitrogen.levelwithout        4.72e-06 ***
Snail.Levelsnail addition:Nitrogen.levelwithout 0.000301 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.788 on 12 degrees of freedom
Multiple R-squared:  0.9284,    Adjusted R-squared:  0.8986 
F-statistic: 31.14 on 5 and 12 DF,  p-value: 1.792e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sdm_model_wls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Standing.Dead..dry..m2. ~ Snail.Level * Nitrogen.level, 
    data = valdez_2023[valdez_2023$Snail.Level != "uncaged", 
        ], weights = wt_sdm)

Weighted Residuals:
     Min       1Q   Median       3Q      Max 
-2.31784 -0.89013 -0.03702  0.92266  2.46121 

Coefficients:
                                                Estimate Std. Error t value
(Intercept)                                       18.710      2.140   8.743
Snail.Levelremoval                               -14.150      2.202  -6.426
Snail.Levelsnail addition                         -7.567      2.490  -3.039
Nitrogen.levelwithout                            -15.240      2.176  -7.004
Snail.Levelremoval:Nitrogen.levelwithout          16.153      2.322   6.956
Snail.Levelsnail addition:Nitrogen.levelwithout   10.357      2.620   3.953
                                                Pr(&gt;|t|)    
(Intercept)                                     1.50e-06 ***
Snail.Levelremoval                              3.27e-05 ***
Snail.Levelsnail addition                        0.01030 *  
Nitrogen.levelwithout                           1.43e-05 ***
Snail.Levelremoval:Nitrogen.levelwithout        1.53e-05 ***
Snail.Levelsnail addition:Nitrogen.levelwithout  0.00192 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.631 on 12 degrees of freedom
Multiple R-squared:  0.8747,    Adjusted R-squared:  0.8225 
F-statistic: 16.75 on 5 and 12 DF,  p-value: 4.789e-05</code></pre>
</div>
</div>
<p>Why not just always do this? Because weighted least squares implicitly assumes we <em>know</em> the weights. We are actually estimating them, so small datasets may lead to bad estimates and outcomes.</p>
</section>
<section id="plotting-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="plotting-outcomes">Plotting outcomes</h2>
<p>Results from two-way ANOVAs are often plotted similarly to one-way ANOVAs, but with colors or other aesthetics representing the additional group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>sdm_summary <span class="ot">&lt;-</span> <span class="fu">summarySE</span>(valdez_2023[valdez_2023<span class="sc">$</span>Snail.Level <span class="sc">!=</span> <span class="st">"uncaged"</span>,], <span class="at">measurevar =</span> <span class="st">"Standing.Dead..dry..m2."</span>, <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">"Snail.Level"</span>, <span class="st">"Nitrogen.level"</span>))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>sdm_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Snail.Level Nitrogen.level N Standing.Dead..dry..m2.        sd        se
1 control snails     Fertilized 3               18.710000 3.6626220 2.1146158
2 control snails        without 3                3.470000 1.0013491 0.5781292
3        removal     Fertilized 3                4.560000 0.4250882 0.2454248
4        removal        without 3                5.473333 1.4150029 0.8169523
5 snail addition     Fertilized 3               11.143333 1.3025104 0.7520047
6 snail addition        without 3                6.260000 0.9417006 0.5436911
        ci
1 9.098457
2 2.487489
3 1.055978
4 3.515062
5 3.235615
6 2.339314</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>sdm_summary<span class="sc">$</span>Snail.Level <span class="ot">&lt;-</span> <span class="fu">relevel</span>(sdm_summary<span class="sc">$</span>Snail.Level, <span class="st">"removal"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sdm_summary, <span class="fu">aes</span>(<span class="at">x=</span>Snail.Level, </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y=</span>Standing.Dead..dry..m2.,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill=</span>Nitrogen.level)) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">position=</span><span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>Standing.Dead..dry..m2., <span class="at">ymax=</span>Standing.Dead..dry..m2.<span class="sc">+</span>ci), <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Grazing impacts depend on nitrogen levels"</span>,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Grazing level"</span>,</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Standing dry mass ("</span> , g<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, m<span class="sc">^</span>{<span class="sc">-</span><span class="dv">2</span>}, <span class="st">")"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="More_ANOVAs_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next steps</h2>
<p>In the next chapters we will carry our linear model approach to consider the relationship between continous outcomes and continuous predictor variables.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-mcdonald2014" class="csl-entry" role="listitem">
McDonald, J. H. 2014. <em>Handbook of Biological Statistics</em>. 3rd ed. Baltimore, MD: Sparky House Publishing.
</div>
<div id="ref-valdez2023" class="csl-entry" role="listitem">
Valdez, Stephanie R., Pedro Daleo, David S. DeLaMater Iii, and Brian R. Silliman. 2023. <span>“Variable Responses to Top-down and Bottom-up Control on Multiple Traits in the Foundational Plant, Spartina Alterniflora.”</span> <em>PLOS ONE</em> 18 (5): e0286327. <a href="https://doi.org/10.1371/journal.pone.0286327">https://doi.org/10.1371/journal.pone.0286327</a>.
</div>
<div id="ref-wiebe2002" class="csl-entry" role="listitem">
Wiebe, Karen L., and Gary R. Bortolotti. 2002. <span>“Variation in Carotenoid-Based Color in Northern Flickers in a Hybrid Zone.”</span> <em>The Wilson Bulletin</em> 114 (3): 393–400. <a href="http://www.jstor.org/stable/4164474">http://www.jstor.org/stable/4164474</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/chapters/Compare_means_among_populations.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Compare means among groups</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/acknowledgements.html" class="pagination-link">
        <span class="nav-page-text">Acknowledgements</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© CC BY-NC-SA 4.0</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>